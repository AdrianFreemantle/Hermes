@{
    ViewBag.Title = "Results";
}

<h2>Monitor</h2>
<div>
    <p>
        Completed: <span class="completedLine">Loading..</span>
    </p>
    <p>
        Completed: <span class="completedBar">Loading..</span>
    </p>
    
    <p>
        Failed: <span class="failedLine">Loading..</span>
    </p>
    <p>
        Failed: <span class="failedBar">Loading..</span>
    </p>
</div>

@section scripts {
    <!--Script references. -->
    <!--The jQuery library is required and is referenced by default in _Layout.cshtml. -->
    <!--Reference the SignalR library. -->
    <script src="~/Scripts/jquery-1.7.1.js"></script>
    <script src="~/Scripts/jquery.signalR-2.0.0.min.js"></script>
    <script src="~/Scripts/jquery.sparkline-2.1.2.min.js"></script>

    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>
    <!--SignalR script to update the chat page and send messages.--> 
    <script>
        $(function () {
            var chat = $.connection.messageMonitor;
            chat.client.addMessageResultToPage = function (goodQueue, badQueue) {
                
                $('.completedLine').sparkline(goodQueue, { lineColor: 'green'});
                $('.completedBar').sparkline(goodQueue, { type: 'bar', barColor: 'green' });
                
                $('.failedLine').sparkline(badQueue, { lineColor: 'red' });
                $('.failedBar').sparkline(badQueue, { type: 'bar', barColor: 'red' });
            };
           
            $.connection.hub.start().done(function () {
             
            });
        });
    </script> 
}
